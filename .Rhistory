#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
# player_df_list[[i]]<-scale(player_df_list[[i]])
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
View(player_df_list[[1]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]]$inactive_for_last_7_days<-player_df_list[[i]]$inactive_for_last_7_days+0.001
player_df_list[[i]]$has_decreasing_session_lengths<-player_df_list[[i]]$has_decreasing_session_lengths+0.001
player_df_list[[i]]$max_session<-player_df_list[[i]]$max_session+0.001
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]]$inactive_for_last_7_days<-player_df_list[[i]]$inactive_for_last_7_days+0.001
player_df_list[[i]]$has_decreasing_session_lengths<-player_df_list[[i]]$has_decreasing_session_lengths+0.001
player_df_list[[i]]$max_session<-player_df_list[[i]]$max_session+0.001
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
str(player_df_list[[1]])
class(player_df_list[[1]]$max_session)
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins)
player_df_list[[i]]$inactive_for_last_7_days<-as.numeric(player_df_list[[i]]$inactive_for_last_7_days)
player_df_list[[i]]$has_decreasing_session_lengths<-as.numeric(player_df_list[[i]]$has_decreasing_session_lengths)
player_df_list[[i]]$max_session<-as.numeric(player_df_list[[i]]$max_session)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
View(player_df_list[[1]])
class(player_df_list[[1]]$max_Session)
class(player_df_list[[1]]$max_session)
class(player_df_list[[1]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
#player_df_list[[i]]$inactive_for_last_7_days<-as.numeric(player_df_list[[i]]$inactive_for_last_7_days)
#player_df_list[[i]]$has_decreasing_session_lengths<-as.numeric(player_df_list[[i]]$has_decreasing_session_lengths)
#player_df_list[[i]]$max_session<-as.numeric(player_df_list[[i]]$max_session)
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
View(player_df_list[[1]])
str(player_df_list[[1]])
class(player_df_list[[1]]$max_sessions)
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]]$inactive_for_last_7_days<-as.numeric(player_df_list[[i]]$inactive_for_last_7_days)+0.001
player_df_list[[i]]$has_decreasing_session_lengths<-as.numeric(player_df_list[[i]]$has_decreasing_session_lengths)+0.001
player_df_list[[i]]$max_session<-as.numeric(player_df_list[[i]]$max_session)+0.001
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
View(player_df_list[[1]])
View(player_df_list[[2]])
View(player_df_list[[12]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]]
player_df_list[[i]][is.nan(player_df_list[[i]])] <- 0
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]]
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0
}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
}
View(player_df_list[[12]])
View(player_df_list[[1]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
}
View(player_df_list[[1]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
names(player_df_list[[i]]$coin_spent)<-"gold_spent"
}
#for each player where sessions < session count, find which node in the some they are at
player_df_list[[1]]
colnames(player_df_list[[i]]$coin_spent)
(player_df_list[[i]]$coin_spent)
class(player_df_list[[i]])
class(non_spenders)
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
colnames(player_df_list[[i]]$coin_spent)<-"gold_spent"
}
#for each player where sessions < session count, find which node in the some they are at
length(player_df_list)
kohonen_codes<- kohonen::getCodes(non_spenders.som)
dist(player_df_list[[i]][1,],kohonen_codes)
for(session in (player_df_list)){summarise(session)}
for(session in (player_df_list)){print(nrow(session))}
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (player_df_list)){
i<-1
min_node_distance<-c()
for(player in (session)){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(player,node))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
session<-cbind(session,min_node_distances) #add distance to nearest node to all players
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (player_df_list)){
i<-1
min_node_distances<-c()
for(player in (session)){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(player,node))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
session<-cbind(session,min_node_distances) #add distance to nearest node to all players
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (player_df_list)){
i<-1
min_node_distances<-c()
for(player in (session)){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(player,node))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
print(i)
}
session<-cbind(session,min_node_distances) #add distance to nearest node to all players
}
player_df_list[[1]]
nrow(player_df_list[[1]])
nrow(kohonen_codes)
length(node_distances)
node_distances
nrow(kohonen_nodes)
nrow(kohonen_codes)
player
for(session in (player_df_list[1:2])){View(head(session))
)
for(session in (player_df_list[1:2])){View(head(session))}
for(session in (player_df_list[1:2])){for(player in (session[1:2,])) {View(player)}}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
player_df_list_updated <- list()
j=1
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (player_df_list)){
i<-1
min_node_distances<-c()
for(player in (1:nrow(session))){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(session[player,],node))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
print(i)
}
player_df_list_updated[j]<-cbind(session,min_node_distances) #add distance to nearest node to all players
}
View(player_df_list_updated[[1]])
player_df_list_updated
kohonen_nodes[3,]
kohonen_codes[3,]
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
player_df_list_updated <- list()
j=1
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (player_df_list)){
i<-1
min_node_distances<-c()
for(player in (1:nrow(session))){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(session[player,],kohonen_codes[node,]))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
player_df_list_updated[j]<-cbind(session,min_node_distances) #add distance to nearest node to all players
j=j+1
print(j)
}
View(player_df_list_updated[[1]])
player_df_list_updated
player_df_list[1]
player_df_list[3]
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
player_df_list_updated <- list()
j=1
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (1:length(player_df_list))){
i<-1
min_node_distances<-c()
for(player in (1:nrow(player_df_list[session]))){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(session[player,],kohonen_codes[node,]))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
player_df_list_updated[j]<-cbind(player_df_list[session],min_node_distances) #add distance to nearest node to all players
j=j+1
print(j)
}
nrow(player_df_list[1])
nrow(player_df_list[[1]])
setwd("D:/R code/projects/SOM")
#load in non spenders list of dataframes by session (player_df_list)
load("spenders.Rdata")
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
#clean the player data
for(i in (1:length(player_df_list))){
player_df_list[[i]] <-
as.data.frame(select(player_df_list[[i]],max_day,active_days,max_session,gametime_hrs,furthest_level,coin_spent,
num_level_attempts,num_unique_levels_attempted,avg_pass_rate,signed_in_to_Fb,num_event_rewards_won,max_event_reward_tier,
num_distinct_coin_purchase_items,inactive_for_last_7_days,
max_level_attempts,num_no_boost_attempts,num_no_boost_wins,coin_balance_range,num_stars_won,avg_stars_won_per_level,
median_time_taken,has_decreasing_session_lengths,avg_session_length_mins))
player_df_list[[i]][is.na(player_df_list[[i]])]<-0
player_df_list[[i]]<-scale(player_df_list[[i]])
player_df_list[[i]][is.nan.data.frame(player_df_list[[i]])] <- 0 #keep an eye on this - it is replacing attributes which don;t apply at low session counts with 0
}
kohonen_codes<- kohonen::getCodes(non_spenders.som)
player_df_list_updated <- list()
j=1
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (1:length(player_df_list))){
i<-1
min_node_distances<-c()
for(player in (1:nrow(player_df_list[[session]]))){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(player_df_list[[session]][player,],kohonen_codes[node,]))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
player_df_list_updated[j]<-cbind(player_df_list[[session]],min_node_distances) #add distance to nearest node to all players
j=j+1
print(j)
}
player_df_list_updated[[1]]
player_df_list_updated <- list()
j=1
#for each player where sessions < session count, find which node in the some they are closest to
for(session in (1:length(player_df_list))){
i<-1
min_node_distances<-c()
for(player in (1:nrow(player_df_list[[session]]))){
node_distances <- c()
for(node in (1:nrow(kohonen_codes))){
node_distances[node]<-dist(rbind(player_df_list[[session]][player],kohonen_codes[node,]))
}
min_node_distances[i]<-min(node_distances) #get minimum node distance and add to the vector of minimum distances
i<-i+1
}
player_df_list_updated[j]<-cbind(player_df_list[[session]],min_node_distances) #add distance to nearest node to all players
j=j+1
print(j)
}
player_df_list_updated[[1]]
player_df_list_updated[[5]]
player_df_list[[session]][player]
session
player
player_df_list[[session]][player,]
kohonen_codes[node,]
